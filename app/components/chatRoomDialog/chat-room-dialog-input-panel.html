<link rel="import" href="../../../bower_components/polymer/polymer.html">

<link rel="import" href="../../../bower_components/iron-icons/iron-icons.html">

<dom-module id="chat-room-dialog-input-panel">
    <template>
        <style>
            :host { 
                width: 100%;
                height: calc(40% - 50px);
                display: block;
            }

            form {
                width: 100%;
                height: 100%;
                display: flex;
                flex-direction: column;
            }

            textarea {
                border: none;
                width: calc(100% - 20px);
                height: calc(100% - 70px);
                padding: 0;
                margin: 10px;
                margin-bottom: 0;
                font-size: 18px;
                font-family: 'Microsoft Yahei';
                resize: none;
            }
            textarea:focus {
                outline: none;
            }

            button.send-btn {
                width: 40px;
                height: 40px;
                align-self: flex-end;
                background: rgb(86,124,115);
                border: none;
                border-radius: 20px;
                margin: 5px 20px;
                cursor: pointer;
                position: relative;
                box-shadow: 1px 5px 12px #ccc;
                transition: background .2s;
            }
            button.send-btn:hover {
                background: rgb(105, 150, 140);
            }
            button.send-btn:active {
                background: rgb(135, 171, 163);
            }
            button.send-btn:focus {
                outline: none;
            }

            .icon {
                position: absolute;
                top: 8px;
                left: 10px;
                fill: #fff;
            }
        </style>

        <form>
            <textarea id="input" value="{{message::input}}" on-keydown="_handleKeyDown" autofocus></textarea>
            <button type="button" class="send-btn" on-click="_send"><iron-icon icon="icons:send" class="icon"></iron-icon></button>
        </form>
    </template>
    <script type="module">
        class ChatRoomDialogInputPanel extends Polymer.Element {
            static get is() { return 'chat-room-dialog-input-panel'; }

            static get properties() {
                return {
                    message: {
                        type: String,
                        value: ''
                    }
                }
            }

            _handleKeyDown(e) {
                if (e.keyCode === 13 && e.ctrlKey) {
                    this._send();
                }
            }

            _clear() {
                this.set('message', '');
            }

            _send() {
                const message = this.message;
                message && this.dispatchEvent(new CustomEvent('send-message', { detail: { message }}));
                this._clear();
            }
        }

        window.customElements.define(ChatRoomDialogInputPanel.is, ChatRoomDialogInputPanel);
    </script>
</dom-module>